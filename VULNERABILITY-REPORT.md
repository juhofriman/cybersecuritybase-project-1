#SECMSG Vulnerability report

It has been noticed that service called SECMSG contains multiple major level vulnerabilities. Sources are available from https://github.com/juhofriman/cybersecuritybase-project-1 and application is made with JVM (Java Virtual Machine) hosted Clojure language. Clojure is functional language in LISP tradition. Application does not have vast amount of dependencies, but they include ring (http server) and enlive (functional templating library). Comprehensive dependency listing is available at https://clojars.org/cybersecuritybase-project-1/versions/0.1.0-SNAPSHOT. Application is form based web application which does not include any javascript.

This document reports found vulnerabilities and suggests actions in order to make SECMSG more secure. Testing is done without https and it is expected that production deployments are served stricly from under https.

## 1. vulnerability: Insecure direct object reference

### Steps to reproduce

1. login to system as user "bob"
2. note that bob has one private message
3. login to system as user "mark"
4. open any message user has received
5. alter query parameter (id=2)
6. a secret message is revealed

### Proposed fix

When a single message is queried, recipient should be checked agains currently logged in user and return 404 if they do not match. Note that public messages should be visible to everybody who has valid credentials to the system.